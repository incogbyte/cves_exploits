# CVE-2020-35489
POC for  Contact Form 7 &lt; 5.3.2 - Unrestricted File Upload  ( Maybe Code execution )

```
Author: incogbyte
```

> Maybe RCE you need to find manually! 

#### PoC for CVE-2020-35489 - Unrestricted File Upload

#### Read FAQ (RCE)

* This bug is **Unrestricted File Upload**, but you can achieve RCE if:
    - (1) the developer create a **form with file upload** and change the **default** behavior of the plugin to store the files sent by email to another location **temporaly**, instead of `/wp-content/uploads/wpcf7_uploads`. to `wp-contents/uploads`
    - (2) - If the (1) is true, you need to find your uploaded file at `wp-content/uploads`. 
    - (3) - **The default behavior of the plugin is save the files sent by email into a "random" temporaly folder at wp-content/uploads/wpcf7_uploads/[random]/yourfile.php, if you exec the file quicky rsrs, you got a RCE :], otherwise the file will be deleted after a 1 sec :/**
    - (4) - By default the file **.htaccess** inside the  `wpcf7_uploads` has **deny from all** access witch means, 403 always

* **To exploit this bug** you need to find the contact form 7 form with **file upload**. Because the default behavior of the plugin, is create a simple form **without** upload field.

#### Requirements

- python3
- requests library

#### - Install
```bash
$ python3 -m pip install requests
```

#### - Usage
```
$ python3 CVE-2020-35489.py -u https://wordpress.site
```
####

#### References

- [https://wpscan.com/vulnerability/10508](https://wpscan.com/vulnerability/10508)
- [https://blog.wpsec.com/contact-form-7-vulnerability/](https://blog.wpsec.com/contact-form-7-vulnerability/)
